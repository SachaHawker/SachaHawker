USE ROLE RL_PROD_MARKETING_ANALYTICS;
USE WAREHOUSE WHS_PROD_MARKETING_ANALYTICS_LARGE;
USE DATABASE CUSTOMER_ANALYTICS;
USE SCHEMA Product_REPORTING;

-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_SKU_MAP;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_EAN;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_sub_category_map;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_category_map;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_posass_flat2;

create or replace temp table sku_list as
SELECT DISTINCT
    SKU.SKU,
    EAN.EAN,
    SKU.SKU_DESC,
    SUBCAT.SUB_CATEGORY_NAME,
    CAT.CATEGORY_NAME
FROM EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_SKU_MAP SKU
INNER JOIN EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_EAN EAN
   ON SKU.SKU_KEY = EAN.SKU_KEY
INNER JOIN EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_sub_category_map SUBCAT
    ON SKU.SUB_CATEGORY_KEY = SUBCAT.SUB_CATEGORY_KEY
INNER JOIN EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_category_map CAT
    ON SKU.CATEGORY_KEY = CAT.CATEGORY_KEY
WHERE EAN.EAN_END_DATE IS NULL
    AND SKU.SKU in
      (
3476,
35309,
131544,
174213,
408950,
487245,
558075,
603379,
1004649,
1043365,
1133578,
1191905,
1389463,
1296297,
6325944,
6325939,
6335923,
6335920,
6345018,
7749846,
6710016,
6710040,
6857119,
7207653,
7214548,
7355601,
7472589,
7493724,
7511188,
7511155,
7549595,
7553544,
7555681,
7572444,
7602168,
7651463,
7659187,
7664552,
7725990,
7735291,
7742133,
7820102,
7832864,
7845255,
7862858,
7889307,
7916916,
7918161,
7918284,
7925050,
7925048,
7938631,
7961735,
7939822,
7944887,
8123416,
7963649,
8123407,
8123409,
7990218,
7991364,
7996465,
7996498,
7997651,
8123432,
8003715,
8003706,
8003699,
8012543,
8019434,
8019436,
8026422,
8032770,
8032796,
8037928,
8121648,
8121635,
8058009,
8062496,
8063067,
8072371,
8074164,
8075260,
8075698,
8078557,
8086637,
8096289,
8099596,
8099593,
8099589,
8099624,
8099617,
8099621,
8099619,
8099839,
8101467,
8103963,
8103949,
8104528,
8105807,
8106004,
8106789,
8107010,
8112187,
8114404,
8114406,
8117155,
8118316,
8118320,
8118318,
8118322,
8119485,
8119483,
8119584,
8119578,
8119824,
8119818,
8119828,
8119833,
8119826,
8119822,
8119820,
8120290,
8120286,
8120282,
8120894,
8120922,
8120935,
8120906,
8121182,
8121508,
8121506,
8121567,
8121565,
8121578,
8121563,
8121729,
8121804,
8121836,
8121831,
8121838,
8121840,
8121871,
8121960,
8121985,
8121958,
8122292,
8122286,
8124049,
8124078,
8124898,
8124896,
8125311,
8126039,
8126988,
8127093,
8128649,
8132674,
8132662,
246,
247,
248,
242,
243,
244,
249,
253,
410175,
558075,
1004649,
1296297,
6481855,
6872075,
7103183,
7207653,
7207643,
7318884,
7493724,
7554777,
7568041,
7640075,
7641833,
7657423,
7714190,
7771953,
7875220,
7898856,
7916557,
7916550,
7916849,
7918161,
7944887,
7944883,
7991924,
8002849,
8031755,
8031759,
8058402,
8060809,
8101978,
8112865,
8112849,
8112863,
8115639,
8115641,
8115645,
8115656,
8123704,
8126039,
251,
250,
7996897,
1174281,
7537774,
7714717,
7700737,
7537809,
3659274,
6825730,
7965955,
7983431,
7230677,
1308228,
7436859,
7555636,
7512184,
8433
     )
;

Select * from SKU_list
Order by SKU;


