USE ROLE RL_PROD_MARKETING_ANALYTICS;
USE WAREHOUSE WHS_PROD_MARKETING_ANALYTICS_LARGE;
USE DATABASE CUSTOMER_ANALYTICS;
USE SCHEMA Product_REPORTING;

-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_SKU_MAP;
select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_EAN limit 5;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_sub_category_map;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_category_map;
-- select * from EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_posass_flat2;

create or replace temp table sku_list as
SELECT DISTINCT
    SKU.SKU,
    EAN.EAN,
    SKU.SKU_DESC,
    SUBCAT.SUB_CATEGORY_NAME,
    CAT.CATEGORY_NAME,
    EAN.primary_upc_EAN_ind
FROM EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_SKU_MAP SKU
INNER JOIN EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.VW_EAN EAN
   ON SKU.SKU_KEY = EAN.SKU_KEY
INNER JOIN EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_sub_category_map SUBCAT
    ON SKU.SUB_CATEGORY_KEY = SUBCAT.SUB_CATEGORY_KEY
INNER JOIN EDWS_PROD.PROD_EDW_SAS_ADHOC_VIEWS.vw_category_map CAT
    ON SKU.CATEGORY_KEY = CAT.CATEGORY_KEY
WHERE EAN.EAN_END_DATE IS NULL
    AND SKU.SKU in
      (8016885,
8016997,
8105840,
8119462,
8119460,
7683699,
32056,
7791046,
8009487,
117975,
1162622,
323628,
6621757,
332286,
7659897,
1244885,
7683267,
1162615,
7176881,
8088507,
6365335,
7912097,
7982664,
8088466

     )
;

Select * from SKU_list
Order by SKU;


